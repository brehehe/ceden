window.requestAnimFrame=function(a){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}();var ruby_sticky_sidebar={blocks:[],last_height:0,parent:".ruby-section",is_enable:!0,w_height:jQuery(window).height(),sticky_sidebar:function(a){a.length>0&&a.each(function(){var a=jQuery(this);a.hasClass("is-sticked")||(a.addClass("is-sticked"),ruby_sticky_sidebar.add_block(a))}),jQuery(window).scroll(function(){ruby_sticky_sidebar.check_events_scroll()}),ruby_sticky_sidebar.window_resize()},window_resize:function(){jQuery(window).resize(function(){ruby_sticky_sidebar.reset_flags(),ruby_sticky_sidebar.is_enable=!0,ruby_sticky_sidebar.w_height=jQuery(window).height();var a=jQuery(window).width();768>a&&(ruby_sticky_sidebar.is_enable=!1)})},add_block:function(a){var b=ruby_sticky_sidebar.create_block(a);"undefined"!=typeof b&&(ruby_sticky_sidebar.add_clearfix(b),b.content_top=0,b.content_bottom=0,b.sidebar_top=0,b.status="top_content",b.sidebar_bottom=0,ruby_sticky_sidebar.blocks.push(b))},create_block:function(a){var b={};if(b.sidebar=a,b.content=a.parents(".ruby-section").find(".ruby-content-wrap"),0!=b.content.length)return b},add_clearfix:function(a){a.sidebar.prepend('<div class="clearfix"></div>').append('<div class="clearfix"></div>'),a.content.prepend('<div class="clearfix"></div>').append('<div class="clearfix"></div>')},block_position:function(a){return a.content_top=a.content.offset().top,a.content_height=a.content.height(),a.content_bottom=a.content_top+a.content_height,a.sidebar_height=a.sidebar.height(),a.sidebar_width=a.sidebar.parent(".sidebar-wrap").width(),a},sidebar_position:function(a){return a.sidebar_top=a.sidebar.offset().top,a.sidebar_bottom=a.sidebar_top+a.sidebar_height,a},block_status:function(a,b,c){var d=ruby_sticky_sidebar.w_height+c;return a.sidebar_height+100>=a.content_height?a.status="content_small":a.sidebar_height<=ruby_sticky_sidebar.w_height?c<a.content_top?a.status="top_content":a.content_bottom-a.sidebar_height>=c?a.status="fixed_top":a.status="bottom_content":a.sidebar_bottom<c?a.status="bottom_content":(a.sidebar_bottom<d&&a.sidebar_bottom<a.content_bottom&&"down"==b&&a.content_bottom>d?a.status="fixed_bottom":a.sidebar_top<=a.content_top&&"up"==b&&a.content_bottom>=d?a.status="top_content":a.content_bottom<=a.sidebar_bottom&&"down"==b||a.content_bottom<d?a.status="bottom_content":c<=a.sidebar_top&&"up"==b&&a.content_top<=c&&(a.status="fixed_top"),("up"==b&&"fixed_bottom"==a.status||"fixed_top"==a.status&&"down"==b)&&(a.status="absolute")),a.status},check_events_scroll:function(){if(ruby_sticky_sidebar.is_enable===!1)for(var a=0;a<ruby_sticky_sidebar.blocks.length;a++)ruby_sticky_sidebar.blocks[a].sidebar.css({width:"auto",position:"static",top:"auto",bottom:"auto"});else{var b,c=jQuery(window).scrollTop();b=c!=ruby_sticky_sidebar.last_height&&c>ruby_sticky_sidebar.last_height?"down":"up",window.requestAnimFrame(function(){ruby_sticky_sidebar.last_height=c,jQuery.each(ruby_sticky_sidebar.blocks,function(a){var d=ruby_sticky_sidebar.blocks[a];switch(ruby_sticky_sidebar.block_position(d),ruby_sticky_sidebar.sidebar_position(d),d.status=ruby_sticky_sidebar.block_status(d,b,c),d.status){case"fixed_bottom":if(!0===d.fixed_bottom_run_once)break;d.fixed_top_run_once=!1,d.fixed_bottom_run_once=!0,d.top_content_run_once=!1,d.bottom_content_run_once=!1,d.absolute_run_once=!1,d.content_small_run_once=!1,d.sidebar.css({width:d.sidebar_width,position:"fixed",top:"auto",bottom:"0","z-index":"100"});break;case"top_content":if(!0===d.top_content_run_once)break;d.fixed_top_run_once=!1,d.fixed_bottom_run_once=!1,d.top_content_run_once=!0,d.bottom_content_run_once=!1,d.absolute_run_once=!1,d.content_small_run_once=!1,d.sidebar.css({width:"auto",position:"static",top:"auto",bottom:"auto"});break;case"bottom_content":if(!0===d.bottom_content_run_once&&d.bottom_content_last_sidebar_height==d.sidebar_height&&d.bottom_content_content_height==d.content_height)break;d.fixed_top_run_once=!1,d.fixed_bottom_run_once=!1,d.top_content_run_once=!1,d.bottom_content_run_once=!0,d.absolute_run_once=!1,d.content_small_run_once=!1,d.bottom_content_last_sidebar_height=d.sidebar_height,d.bottom_content_content_height=d.content_height,d.sidebar.css({width:d.sidebar_width,position:"absolute",top:d.content_bottom-d.sidebar_height-d.content_top,bottom:"auto"});break;case"fixed_top":if(!0===d.fixed_top_run_once)break;d.fixed_top_run_once=!0,d.fixed_bottom_run_once=!1,d.top_content_run_once=!1,d.bottom_content_run_once=!1,d.absolute_run_once=!1,d.content_small_run_once=!1,d.sidebar.css({width:d.sidebar_width,position:"fixed",top:0,bottom:"auto"});break;case"absolute":if(!0===d.absolute_run_once)break;d.fixed_top_run_once=!1,d.fixed_bottom_run_once=!1,d.top_content_run_once=!1,d.bottom_content_run_once=!1,d.absolute_run_once=!0,d.content_small_run_once=!1,d.sidebar.css({width:d.sidebar_width,position:"absolute",top:d.sidebar_top-d.content_top,bottom:"auto"});break;case"content_small":if(!0===d.content_small_run_once)break;d.fixed_top_run_once=!1,d.fixed_bottom_run_once=!1,d.top_content_run_once=!1,d.bottom_content_run_once=!1,d.absolute_run_once=!1,d.content_small_run_once=!0,d.sidebar.css({width:"auto",position:"static",top:"auto",bottom:"auto"})}})})}},reset_flags:function(){for(var a=0;a<ruby_sticky_sidebar.blocks.length;a++)ruby_sticky_sidebar.blocks[a].fixed_top_run_once=!1,ruby_sticky_sidebar.blocks[a].fixed_bottom_run_once=!1,ruby_sticky_sidebar.blocks[a].top_content_run_once=!1,ruby_sticky_sidebar.blocks[a].bottom_content_run_once=!1,ruby_sticky_sidebar.blocks[a].absolute_run_once=!1,ruby_sticky_sidebar.blocks[a].content_small_run_once=!1,ruby_sticky_sidebar.blocks[a].bottom_content_last_sidebar_height=0,ruby_sticky_sidebar.blocks[a].bottom_content_last_content_height=0}};